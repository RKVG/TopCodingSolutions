<div style="margin-top:0px;margin-bottom:5px;font-size:18px;font-weight:bold;text-decoration:underline">
    Problem Statement:
</div>
<a href="http://www.codechef.com/JULY14/problems/DISHOWN" target="_blank">CodeChef:
    Dish
    Owner</a>

<div style="margin-top:20px;margin-bottom:5px;font-size:18px;font-weight:bold;text-decoration:underline">
    Overview:
</div>
<p>
    Keep track of winners in a cooking competition.
</p>


<div style="margin-top:20px;margin-bottom:5px;font-size:18px;font-weight:bold;text-decoration:underline">
    Java Source:
</div>
<pre style="background:#000000;color:#fdbb30;font-family:Courier New,Courier,monospace;font-size:14px;height:auto;line-height:20px;overflow:auto;padding:20px;text-align:left;width:95%">
    01: /*
    02: CodeChef
    03: July Challenge 2014
    04: Description: http://www.codechef.com/JULY14/problems/DISHOWN
    05:  */
    06:
    07: import java.io.File;
    08: import java.util.Scanner;
    09:
    10: public class DishOwner {
    11:
    12:     public static void main(String[] args) throws Exception {
    13:
    14:         Scanner sc;
    15:
    16:         // If an arg is given, read from that file. Otherwise use stdin.
    17:         if (args.length > 0) {
    18:             File f = new File(args[0]);
    19:             sc = new Scanner(f);
    20:         } else {
    21:             sc = new Scanner(System.in);
    22:         }
    23:
    24:         // Get number of Test Cases
    25:         int numTestCases = Integer.parseInt(sc.nextLine());
    26:
    27:         for (int i = 0; i < numTestCases; i++) {
    28:
    29:             // Get number of Chefs
    30:             int numOfChefs = Integer.parseInt(sc.nextLine());
    31:
    32:             // Set dish owners
    33:             int[] owners = new int[numOfChefs];
    34:             for (int owner = 0; owner < numOfChefs; owner++) {
    35:                 owners[owner] = owner;
    36:             }
    37:
    38:             // Set scores for each Dish
    39:             int[] scores = new int[numOfChefs];
    40:
    41:             int dish = 0;
    42:             for (String s : sc.nextLine().split(" ")) {
    43:                 scores[dish++] = Integer.parseInt(s);
    44:             }
    45:
    46:             // Get number of Queries
    47:             int numOfQueries = Integer.parseInt(sc.nextLine());
    48:
    49:             // Process each query
    50:             for (int q = 0; q < numOfQueries; q++) {
    51:                 String[] query = sc.nextLine().split(" ");
    52:
    53:                 if (query.length == 3) {
    54:                     doCompetition(Integer.parseInt(query[1]) - 1,
    55:                             Integer.parseInt(query[2]) - 1, scores, owners);
    56:                 } else {
    57:                     System.out.println(getDishOwner(Integer.parseInt
    58:                             (query[1]) - 1, owners) + 1);
    59:                 }
    60:             }
    61:         }
    62:     }
    63:
    64:     private static void doCompetition(int dish1, int dish2, int[] scores,
    65:                                       int[] owners) {
    66:
    67:         int chef1 = getDishOwner(dish1, owners);
    68:         int chef2 = getDishOwner(dish2, owners);
    69:
    70:         if (chef1 == chef2) {
    71:             System.out.println("Invalid query!");
    72:             return;
    73:         }
    74:
    75:         if (scores[dish1] > scores[dish2]) {
    76:             owners[dish2] = chef1;
    77:         } else if (scores[dish2] > scores[dish1]) {
    78:             owners[dish1] = chef2;
    79:         } else {
    80:             // Tie. do nothing
    81:         }
    82:     }
    83:
    84:     private static int getDishOwner(int dish, int[] owners) {
    85:
    86:         int chef = dish;
    87:         while (owners[dish] != chef) {
    88:             chef = owners[dish];
    89:         }
    90:         return chef;
    91:     }
    92: }
</pre>

<div style="margin-top:20px;margin-bottom:5px;font-size:18px;font-weight:bold;text-decoration:underline">
    Notes:
</div>
<p>
    This is the first problem that I've attempted on the CodeChef.com site. I
    haven't registered for an account there, so I did not submit this code, and
    therefore I cannot guarantee that it passes their tests. It does however
    pass their example and my own unit tests.
</p>

<p>
    The algorithm works by maintaining two integer arrays - scores, and
    owners. There are at most 10^4 chefs, and scores may be as large as
    10^6 which easily fit into an int. Scores simply holds the scores for each
    dish. Once set, their values never change. owners initially holds the chef
    that brought the dish to the competion, but as challenges are won and lost,
    these values change.
</p>

<p>
    The problem states that each chef chooses their dish optimally, and
    there is no constraint prohibiting them from using the same dish
    multiple times. I took
    this to mean that they always put up their highest scoring dish which
    will be the dish they started with since it's impossible to obtain one
    with a higher score. This also means that if the value in the owners
    array matches it's index, then that chef has never lost.
</p>

<p>
    When a competition starts, I first determine the owner of the two dishes,
    more on this next. It checks to see if the owners are the same. Then
    determines a winner (or a tie). Here, the loser's owner is set to the
    winning chef. That is, in the owners array, the value at index loser is
    set to the winner: owners[loser] = winner
</p>

<p>
    Now, to determine a dish's owner, we look into the owners array, and
    follow the chain up until the owner of the dish is the same value as the
    chef. The following table shows the state of the owners array after a
    series of competitions.
</p>

<table border="0">
    <tr>
        <th></th>
        <th>owners</th>
    </tr>
    <tr>
        <td>Initial Setup:</td>
        <td>
            <table border="1">
                <tr>
                    <td>index</td>
                    <td>0</td>
                    <td>1</td>
                    <td>2</td>
                </tr>
                <tr>
                    <td>value</td>
                    <td>0</td>
                    <td>1</td>
                    <td>2</td>
                </tr>
            </table>
        </td>
    </tr>
    <tr>
        <td>Dish 2 beats Dish 0:</td>
        <td>
            <table border="1">
                <tr>
                    <td>index</td>
                    <td>0</td>
                    <td>1</td>
                    <td>2</td>
                </tr>
                <tr>
                    <td>value</td>
                    <td><b>2</b></td>
                    <td>1</td>
                    <td>2</td>
                </tr>
            </table>
        </td>
    </tr>
    <tr>
        <td>Dish 1 beats Dish 2:</td>
        <td>
            <table border="1">
                <tr>
                    <td>index</td>
                    <td>0</td>
                    <td>1</td>
                    <td>2</td>
                </tr>
                <tr>
                    <td>value</td>
                    <td>2</td>
                    <td>1</td>
                    <td><b>1</b></td>
                </tr>
            </table>
        </td>
    </tr>
</table>

<p>
    To determine the owner of dish 0 after this series of competitions,
    we look at owners[0] and see the value is 2. Since 0 != 2,
    we then look at owners[2] and see the vaue of 1. Again, 2 != 1,
    so we continue following the chain by looking at owners[1]. Here,
    the index matches the value, so we conclude that 1 is the owner of dish
    0.
</p>

<p>Be careful about subtracting 1 from the index (Lines 54, 55,
    and 58) since the chefs and scores are numbered starting at 1
    while our array starts at 0. We then need to add 1 back on
    when printing out the owner.
</p>

<div style="margin-top:50px;text-align:center;font-size:14px">
    <p><i>Thank you</i> for taking the time to read this solution. I welcome any
        feedback you may have.</p>

    <p>Please post any questions or comments <a
            href="http://blog.topcodingsolutions.net/2014/07/codechef-dish-owner.html"
            target="_blank">here</a>.</p>

    <p>For this, and other TopCoder solutions, please visit <a
            href="http://www.topcodingsolutions.net" target="_blank">www.topcodingsolutions.net</a>.
    </p>
</div>
